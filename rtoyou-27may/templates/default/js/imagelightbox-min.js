(function(c,e,g,b){var h=function(){var k=g.body||g.documentElement,k=k.style;if(k.WebkitTransition==""){return"-webkit-"}if(k.MozTransition==""){return"-moz-"}if(k.OTransition==""){return"-o-"}if(k.transition==""){return""}return false},f=h()===false?false:true,i=function(l,m,o){var k={},n=h();k[n+"transform"]="translateX("+m+")";k[n+"transition"]=n+"transform "+o+"s linear";l.css(k)},d=("ontouchstart" in e),j=e.navigator.pointerEnabled||e.navigator.msPointerEnabled,a=function(k){if(d){return true}if(!j||typeof k==="undefined"||typeof k.pointerType==="undefined"){return false}if(typeof k.MSPOINTER_TYPE_MOUSE!=="undefined"){if(k.MSPOINTER_TYPE_MOUSE!=k.pointerType){return true}}else{if(k.pointerType!="mouse"){return true}}return false};c.fn.imageLightbox=function(w){var w=c.extend({selector:'id="imagelightbox"',animationSpeed:250,preloadNext:true,enableKeyboard:true,quitOnEnd:false,quitOnImgClick:false,quitOnDocClick:true,onStart:false,onEnd:false,onLoadStart:false,onLoadEnd:false},w),q=c([]),r=c(),m=c(),s=0,o=0,k=0,p=false,t=function(){if(!m.length){return true}var y=c(e).width()*0.8,z=c(e).height()*0.9,x=new Image();x.src=m.attr("src");x.onload=function(){s=x.width;o=x.height;if(s>y||o>z){var A=s/o>y/z?s/y:o/z;s/=A;o/=A}m.css({width:s+"px",height:o+"px",top:(c(e).height()-o)/2+"px",left:(c(e).width()-s)/2+"px"})}},l=function(x){if(p){return false}x=typeof x==="undefined"?false:x=="left"?1:-1;if(m.length){if(x!==false&&(q.length<2||(w.quitOnEnd===true&&((x===-1&&q.index(r)==0)||(x===1&&q.index(r)==q.length-1))))){v();return false}var y={opacity:0};if(f){i(m,(100*x)-k+"px",w.animationSpeed/1000)}else{y.left=parseInt(m.css("left"))+100*x+"px"}m.animate(y,w.animationSpeed,function(){u()});k=0}p=true;if(w.onLoadStart!==false){w.onLoadStart()}setTimeout(function(){m=c("<img "+w.selector+" />").attr("src",r.attr("href")).on("load",function(){m.appendTo("body");t();var E={opacity:1};m.css("opacity",0);if(f){i(m,-100*x+"px",0);setTimeout(function(){i(m,0+"px",w.animationSpeed/1000)},50)}else{var D=parseInt(m.css("left"));E.left=D+"px";m.css("left",D-100*x+"px")}m.animate(E,w.animationSpeed,function(){p=false;if(w.onLoadEnd!==false){w.onLoadEnd()}});if(w.preloadNext){var C=q.eq(q.index(r)+1);if(!C.length){C=q.eq(0)}c("<img />").attr("src",C.attr("href"))}}).on("error",function(){if(w.onLoadEnd!==false){w.onLoadEnd()}});var B=0,z=0,A=0;m.on(j?"pointerup MSPointerUp":"click",function(C){C.preventDefault();if(w.quitOnImgClick){v();return false}if(a(C.originalEvent)){return true}var D=(C.pageX||C.originalEvent.pageX)-C.target.offsetLeft;r=q.eq(q.index(r)-(s/2>D?1:-1));if(!r.length){r=q.eq(s/2>D?q.length:0)}l(s/2>D?"left":"right")}).on("touchstart pointerdown MSPointerDown",function(C){if(!a(C.originalEvent)||w.quitOnImgClick){return true}if(f){A=parseInt(m.css("left"))}B=C.originalEvent.pageX||C.originalEvent.touches[0].pageX}).on("touchmove pointermove MSPointerMove",function(C){if(!a(C.originalEvent)||w.quitOnImgClick){return true}C.preventDefault();z=C.originalEvent.pageX||C.originalEvent.touches[0].pageX;k=B-z;if(f){i(m,-k+"px",0)}else{m.css("left",A-k+"px")}}).on("touchend touchcancel pointerup pointercancel MSPointerUp MSPointerCancel",function(C){if(!a(C.originalEvent)||w.quitOnImgClick){return true}if(Math.abs(k)>50){r=q.eq(q.index(r)-(k<0?1:-1));if(!r.length){r=q.eq(k<0?q.length:0)}l(k>0?"right":"left")}else{if(f){i(m,0+"px",w.animationSpeed/1000)}else{m.animate({left:A+"px"},w.animationSpeed/2)}}})},w.animationSpeed+100)},u=function(){if(!m.length){return false}m.remove();m=c()},v=function(){if(!m.length){return false}m.animate({opacity:0},w.animationSpeed,function(){u();p=false;if(w.onEnd!==false){w.onEnd()}})},n=function(x){x.each(function(){q=q.add(c(this))});x.on("click.imageLightbox",function(y){y.preventDefault();if(p){return false}p=false;if(w.onStart!==false){w.onStart()}r=c(this);l()})};c(e).on("resize",t);if(w.quitOnDocClick){c(g).on(d?"touchend":"click",function(x){if(m.length&&!c(x.target).is(m)){v()}})}if(w.enableKeyboard){c(g).on("keyup",function(x){if(!m.length){return true}x.preventDefault();if(x.keyCode==27){v()}if(x.keyCode==37||x.keyCode==39){r=q.eq(q.index(r)-(x.keyCode==37?1:-1));if(!r.length){r=q.eq(x.keyCode==37?q.length:0)}l(x.keyCode==37?"left":"right")}})}n(c(this));this.switchImageLightbox=function(y){var z=q.eq(y);if(z.length){var x=q.index(r);r=z;l(y<x?"left":"right")}return this};this.addToImageLightbox=function(x){n(x)};this.quitImageLightbox=function(){v();return this};return this}})(jQuery,window,document);