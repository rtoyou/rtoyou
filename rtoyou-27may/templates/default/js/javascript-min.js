(function(a){a.fn.scrollPagination=function(b){var c={detailid:47,nop:1,offset:0,error:"No More Reviews!",delay:500,scroll:true,url:"review/getreviews",type:"review",reviewid:0};if(b){a.extend(c,b)}return this.each(function(){$this=a(this);$settings=c;var f=$settings.offset;var e=false;if($settings.scroll==true){$initmessage="Scroll for more or click here"}else{$initmessage="Click for more"}$this.append('<div class="content"></div><div class="loading-bar">'+$initmessage+"</div>");function d(g,h){a.post(g,{action:"scrollpagination",number:$settings.nop,offset:f,detailid:$settings.detailid,reviewid:$settings.reviewid},function(k){$this.find(".loading-bar").html($initmessage);if(k.data.length==0){$this.find(".loading-bar").html($settings.error)}else{if($settings.type=="photopage"){a(document).trigger("onAfterGetPhotos",[k])}else{if($settings.type=="review"){f=f+$settings.nop;var j=k.data;var i=a("#reviewTpl").html();Mustache.parse(i);a.each(j,function(m,l){var n=Mustache.render(i,l);$this.find(".content").append(n)});e=false;if(k.data.length<$settings.nop){$this.find(".loading-bar").html($settings.error);$this.find(".loading-bar").data("more",0)}}}}})}d(c.url);if($settings.scroll==true){a(window).scroll(function(){if(a(window).scrollTop()+a(window).height()>$this.height()&&!e){e=true;$this.find(".loading-bar").html("Loading Reviews");setTimeout(function(){d($settings.url)},$settings.delay)}})}$this.find(".loading-bar").click(function(){if(a(this).data("more")!=0){if(e==false){e=true;d($settings.url)}}})})}})(jQuery);